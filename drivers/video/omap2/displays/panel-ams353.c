/*
 * ams353 panel support
 *
 * Copyright (C) 2009 Samsung Corporation
 * Author: Swin kim <swin.kim@samsung.com>
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 as published by
 * the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for
 * more details.
 *
 * You should have received a copy of the GNU General Public License along with
 * this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 
#include <linux/module.h>
#include <linux/delay.h>
#include <linux/platform_device.h>
#include <linux/i2c/twl.h>
#include <linux/spi/spi.h>
#include <linux/regulator/consumer.h>
#include <linux/err.h>
#include <plat/gpio.h>
#include <plat/hardware.h>
#include <plat/mux.h>
#include <plat/mux_archer_rev_r03.h>
#include <asm/mach-types.h>
#include <plat/control.h>

#include <plat/display.h>

#include <linux/leds.h>

#undef TEST_LCD_SUSPEND
#ifdef TEST_LCD_SUSPEND
#include <linux/wakelock.h>
#include <linux/workqueue.h>
#endif

#include <mach/../../mux.h>

#define LCD_XRES		480
#define LCD_YRES		800
#define LCD_HBP	        16  //8
#define LCD_HFP         16  //8
#define LCD_HSW		    64  //3   // 2	
#define LCD_VBP		    1   // 3 recomanded value in smd
#define LCD_VFP		    28
#define LCD_VSW		    3   // 2	

#define LCD_PIXCLOCK_MAX	        24685       // Archer_LSJ DB07 25530 //12000  
#define LCD_DEFAULT_BRIGHTNESS	    6
#define LCD_DEFAULT_GAMMA           GAMMA_2_2   // 2.2 gamma table.
#define HAND_FLASH_DEFAULT          flash_off	// Archer_LSJ DB10
#define LCD_DEFAULT_ACL_STATE		ACL_OFF
#define LDI_POWER_ON                1
#define LDI_POWER_OFF               0

#define GPIO_LEVEL_LOW   0
#define GPIO_LEVEL_HIGH  1

#define LCD_AR3_GAMMA
#define LCD_ARIAN_GAMMA
#undef __AMS35X_ACL_LEVEL_40__

static struct spi_device *ams353lcd_spi;
int lcdlevel = LCD_DEFAULT_BRIGHTNESS;	
int lcdgamma = LCD_DEFAULT_GAMMA;
int lcdacl   = LCD_DEFAULT_ACL_STATE;
int ldi_power_status = LDI_POWER_ON;         // Archer_LSJ DD14 
    
#ifdef TEST_LCD_SUSPEND
static struct wake_lock lcd_wakelock;
#endif

#ifdef LCD_REFRESH_CHANGE
extern unsigned short int refresh_rate;
extern unsigned short int refresh_count;
#endif

// ------------------------------------------ // 
//          For Regulator Framework           //
// ------------------------------------------ // 
struct regulator *vaux3;
struct regulator *vpll2;

#if defined(CONFIG_MACH_OSCAR) && (CONFIG_OSCAR_REV == CONFIG_OSCAR_EMU02)
struct regulator *vaux2;
#else
struct regulator *vaux4;
#endif

#ifdef  CONFIG_SAMSUNG_ARCHER_TARGET_SK  // KEY LED  // Archer_LSJ DA19
extern u32 hw_revision;
#if 0 // #if (CONFIG_ARCHER_REV >= ARCHER_REV12)
struct regulator *vmmc2;
#endif
#endif

void ams353_lcd_LDO_on(void);
void ams353_lcd_LDO_off(void);
void ams353_lcd_poweron(void);
void ams353_lcd_poweroff(void);
void ams353_ldi_poweron(void);
void ams353_ldi_poweroff(void);
void ams353_ldi_standby(void);
void ams353_ldi_wakeup(void);
void ams353_AutomaticCurrentLimit(void);

//extern int omap34xx_pad_set_config(struct pin_config *pin_config);
//extern int omap34xx_pad_set_configs(struct pin_config *pin_configs, int n);
extern int omap34xx_pad_set_config_lcd(u16,u16);

#define PM_RECEIVER                     TWL4030_MODULE_PM_RECEIVER

#define ENABLE_VPLL2_DEDICATED          0x05
#define ENABLE_VPLL2_DEV_GRP            0x20
#define TWL4030_VPLL2_DEV_GRP           0x33
#define TWL4030_VPLL2_DEDICATED         0x36

#ifdef LCD_AR3_GAMMA
#ifndef LCD_ARIAN_GAMMA
    // 2.2 gamma
    static u8 ams353_300[] = {0x02, 0x18, 0x08, 0x24, 0x72, 0x65, 0x46, 0xBC, 0xBD, 0xAE, 0xAF, 0xB1, 0xA2, 0xBD, 0xC0, 0xB6, 0x00, 0xBA, 0x00, 0xBE, 0x00, 0xF4};
    //static u8 ams353_285[] = {0x02, 0x18, 0x08, 0x24, 0x74, 0x66, 0x48, 0xBD, 0xBE, 0xAF, 0xAF, 0xB2, 0xA2, 0xBE, 0xC0, 0xB6, 0x00, 0xB6, 0x00, 0xBA, 0x00, 0xF0};
    static u8 ams353_270[] = {0x02, 0x18, 0x08, 0x24, 0x75, 0x66, 0x4A, 0xBE, 0xBF, 0xB0, 0xB0, 0xB3, 0xA3, 0xC0, 0xC2, 0xB8, 0x00, 0xB1, 0x00, 0xB5, 0x00, 0xE9};
    //static u8 ams353_255[] = {0x02, 0x18, 0x08, 0x24, 0x75, 0x66, 0x4A, 0xBF, 0xC0, 0xB1, 0xB2, 0xB4, 0xA5, 0xBF, 0xC1, 0xB6, 0x00, 0xAE, 0x00, 0xB2, 0x00, 0xE6};
    static u8 ams353_240[] = {0x02, 0x18, 0x08, 0x24, 0x78, 0x66, 0x4C, 0xBE, 0xBF, 0xB0, 0xB2, 0xB5, 0xA5, 0xC2, 0xC4, 0xBA, 0x00, 0xA9, 0x00, 0xAC, 0x00, 0xDE};
    static u8 ams353_225[] = {0x02, 0x18, 0x08, 0x24, 0x78, 0x66, 0x4D, 0xC1, 0xC1, 0xB2, 0xB2, 0xB5, 0xA6, 0xC3, 0xC5, 0xBA, 0x00, 0xA4, 0x00, 0xA7, 0x00, 0xD8};
    static u8 ams353_210[] = {0x02, 0x18, 0x08, 0x24, 0x7A, 0x66, 0x4F, 0xC0, 0xC1, 0xB2, 0xB5, 0xB7, 0xA8, 0xC4, 0xC6, 0xBB, 0x00, 0x9F, 0x00, 0xA2, 0x00, 0xD2};
    static u8 ams353_195[] = {0x02, 0x18, 0x08, 0x24, 0x7C, 0x66, 0x51, 0xC1, 0xC2, 0xB3, 0xB5, 0xB7, 0xA8, 0xC6, 0xC8, 0xBD, 0x00, 0x9A, 0x00, 0x9D, 0x00, 0xCB};
    static u8 ams353_180[] = {0x02, 0x18, 0x08, 0x24, 0x7E, 0x66, 0x54, 0xC2, 0xC2, 0xB3, 0xB6, 0xB9, 0xAA, 0xC7, 0xC9, 0xBE, 0x00, 0x95, 0x00, 0x97, 0x00, 0xC4};
    static u8 ams353_165[] = {0x02, 0x18, 0x08, 0x24, 0x80, 0x66, 0x56, 0xC2, 0xC2, 0xB3, 0xB8, 0xBA, 0xAB, 0xC8, 0xCA, 0xC0, 0x00, 0x90, 0x00, 0x92, 0x00, 0xBD};
    static u8 ams353_150[] = {0x02, 0x18, 0x08, 0x24, 0x7D, 0x62, 0x4F, 0xC3, 0xC3, 0xB5, 0xBA, 0xBC, 0xAD, 0xC9, 0xCB, 0xC1, 0x00, 0x8A, 0x00, 0x8C, 0x00, 0xB5};
    static u8 ams353_135[] = {0x02, 0x18, 0x08, 0x24, 0x81, 0x62, 0x52, 0xC4, 0xC3, 0xB5, 0xBB, 0xBD, 0xAF, 0xCB, 0xCD, 0xC2, 0x00, 0x84, 0x00, 0x86, 0x00, 0xAE};
    static u8 ams353_120[] = {0x02, 0x18, 0x08, 0x24, 0x83, 0x62, 0x54, 0xC6, 0xC4, 0xB7, 0xBB, 0xBD, 0xAE, 0xCD, 0xCF, 0xC5, 0x00, 0x7E, 0x00, 0x80, 0x00, 0xA6};
    static u8 ams353_105[] = {0x02, 0x18, 0x08, 0x24, 0x87, 0x62, 0x5A, 0xC7, 0xC5, 0xB7, 0xBD, 0xBF, 0xB1, 0xCF, 0xD0, 0xC6, 0x00, 0x77, 0x00, 0x79, 0x00, 0x9D};
    static u8 ams353_90[] = {0x02, 0x18, 0x08, 0x24, 0x8C, 0x62, 0x60, 0xC7, 0xC5, 0xB8, 0xC0, 0xC1, 0xB3, 0xCF, 0xD1, 0xC6, 0x00, 0x71, 0x00, 0x72, 0x00, 0x95};
    static u8 ams353_80[] = {0x02, 0x18, 0x08, 0x24, 0x89, 0x5A, 0x5D, 0xC7, 0xC5, 0xB8, 0xC1, 0xC2, 0xB4, 0xCF, 0xD1, 0xC6, 0x00, 0x6D, 0x00, 0x6E, 0x00, 0x90};
    static u8 ams353_70[] = {0x02, 0x18, 0x08, 0x24, 0x8D, 0x5A, 0x63, 0xC8, 0xC5, 0xB8, 0xC2, 0xC4, 0xB6, 0xD2, 0xD3, 0xC9, 0x00, 0x67, 0x00, 0x68, 0x00, 0x88};
    static u8 ams353_50[]  = {0x02, 0x18, 0x08, 0x24, 0x8A, 0x46, 0x60, 0xCD, 0xC7, 0xBD, 0xC4, 0xC5, 0xB7, 0xD5, 0xD7, 0xCD, 0x00, 0x5B, 0x00, 0x5B, 0x00, 0x78};

     // 1.9 gamma
    static u8 ams353_19_300[] = {0x02, 0x18, 0x08, 0x24, 0x76, 0x73, 0x53, 0xC1, 0xC2, 0xB4, 0xB5, 0xB8, 0xAA, 0xC4, 0xC6, 0xBD, 0x00, 0xBA, 0x00, 0xBE, 0x00, 0xF4};
    static u8 ams353_19_285[] = {0x02, 0x18, 0x08, 0x24, 0x77, 0x73, 0x53, 0xC1, 0xC3, 0xB5, 0xB6, 0xB8, 0xAA, 0xC5, 0xC7, 0xBD, 0x00, 0xB6, 0x00, 0xBA, 0x00, 0xF0};
    static u8 ams353_19_270[] = {0x02, 0x18, 0x08, 0x24, 0x76, 0x74, 0x53, 0xC2, 0xC3, 0xB5, 0xB7, 0xB9, 0xAB, 0xC7, 0xC9, 0xC0, 0x00, 0xB1, 0x00, 0xB5, 0x00, 0xE9};
    static u8 ams353_19_255[] = {0x02, 0x18, 0x08, 0x24, 0x79, 0x75, 0x56, 0xC3, 0xC4, 0xB6, 0xB8, 0xBA, 0xAC, 0xC6, 0xC8, 0xBE, 0x00, 0xAE, 0x00, 0xB2, 0x00, 0xE6};
    static u8 ams353_19_240[] = {0x02, 0x18, 0x08, 0x24, 0x7D, 0x78, 0x5B, 0xC2, 0xC4, 0xB5, 0xB9, 0xBB, 0xAD, 0xC8, 0xCA, 0xC1, 0x00, 0xA9, 0x00, 0xAC, 0x00, 0xDE};
    static u8 ams353_19_225[] = {0x02, 0x18, 0x08, 0x24, 0x7D, 0x78, 0x58, 0xC3, 0xC4, 0xB7, 0xBA, 0xBC, 0xAE, 0xC9, 0xCB, 0xC1, 0x00, 0xA4, 0x00, 0xA7, 0x00, 0xD8};
    static u8 ams353_19_210[] = {0x02, 0x18, 0x08, 0x24, 0x7E, 0x78, 0x5B, 0xC4, 0xC5, 0xB7, 0xBA, 0xBC, 0xAE, 0xCB, 0xCD, 0xC3, 0x00, 0x9F, 0x00, 0xA2, 0x00, 0xD2};
    static u8 ams353_19_195[] = {0x02, 0x18, 0x08, 0x24, 0x80, 0x78, 0x5A, 0xC6, 0xC7, 0xBA, 0xBB, 0xBD, 0xAF, 0xCC, 0xCE, 0xC4, 0x00, 0x9A, 0x00, 0x9D, 0x00, 0xCB};
    static u8 ams353_19_180[] = {0x02, 0x18, 0x08, 0x24, 0x80, 0x78, 0x5B, 0xC7, 0xC7, 0xBA, 0xBC, 0xBE, 0xB0, 0xCD, 0xD0, 0xC6, 0x00, 0x95, 0x00, 0x97, 0x00, 0xC4};
    static u8 ams353_19_165[] = {0x02, 0x18, 0x08, 0x24, 0x83, 0x78, 0x5C, 0xC6, 0xC7, 0xBA, 0xBE, 0xC0, 0xB2, 0xCE, 0xD0, 0xC7, 0x00, 0x90, 0x00, 0x92, 0x00, 0xBD};
    static u8 ams353_19_150[] = {0x02, 0x18, 0x08, 0x24, 0x82, 0x79, 0x5C, 0xC8, 0xC8, 0xBB, 0xBF, 0xC1, 0xB4, 0xD0, 0xD2, 0xC9, 0x00, 0x8A, 0x00, 0x8C, 0x00, 0xB5};
    static u8 ams353_19_135[] = {0x02, 0x18, 0x08, 0x24, 0x87, 0x79, 0x61, 0xC8, 0xC9, 0xBC, 0xC1, 0xC2, 0xB4, 0xD1, 0xD3, 0xCA, 0x00, 0x84, 0x00, 0x86, 0x00, 0xAE};
    static u8 ams353_19_120[] = {0x02, 0x18, 0x08, 0x24, 0x87, 0x79, 0x61, 0xC9, 0xC9, 0xBC, 0xC3, 0xC4, 0xB7, 0xD2, 0xD4, 0xCB, 0x00, 0x7E, 0x00, 0x80, 0x00, 0xA6};
    static u8 ams353_19_105[] = {0x02, 0x18, 0x08, 0x24, 0x89, 0x79, 0x62, 0xCB, 0xCA, 0xBE, 0xC3, 0xC5, 0xB7, 0xD5, 0xD6, 0xCE, 0x00, 0x77, 0x00, 0x79, 0x00, 0x9D};
    static u8 ams353_19_90[]  = {0x02, 0x18, 0x08, 0x24, 0x8E, 0x79, 0x68, 0xCB, 0xCB, 0xBE, 0xC6, 0xC7, 0xBB, 0xD5, 0xD7, 0xCD, 0x00, 0x71, 0x00, 0x72, 0x00, 0x95};
#else
    // 2.2 gamma
    static u8 ams353_300[] = {0x02, 0x18, 0x08, 0x24, 0x72, 0x65, 0x46, 0xBC, 0xBD, 0xAE, 0xAF, 0xB1, 0xA2, 0xBD, 0xC0, 0xB6, 0x00, 0xBA, 0x00, 0xBE, 0x00, 0xF4};
    static u8 ams353_290[] = {0x02, 0x18, 0x08, 0x24, 0x71, 0x65, 0x49, 0xBC, 0xBD, 0xAE, 0xAF, 0xB2, 0xA2, 0xBE, 0xC0, 0xB6, 0x00, 0xB8, 0x00, 0xBC, 0x00, 0xF2};
    static u8 ams353_280[] = {0x02, 0x18, 0x08, 0x24, 0x6F, 0x61, 0x44, 0xBC, 0xBE, 0xAF, 0xB0, 0xB2, 0xA2, 0xBF, 0xC1, 0xB7, 0x00, 0xB5, 0x00, 0xB9, 0x00, 0xEF};
    static u8 ams353_270[] = {0x02, 0x18, 0x08, 0x24, 0x75, 0x66, 0x4A, 0xBE, 0xBF, 0xB0, 0xB0, 0xB3, 0xA3, 0xC0, 0xC2, 0xB8, 0x00, 0xB1, 0x00, 0xB5, 0x00, 0xE9};
    static u8 ams353_260[] = {0x02, 0x18, 0x08, 0x24, 0x6F, 0x61, 0x47, 0xBD, 0xBE, 0xAE, 0xB2, 0xB5, 0xA6, 0xBF, 0xC1, 0xB6, 0x00, 0xB0, 0x00, 0xB3, 0x00, 0xE8};
    static u8 ams353_250[] = {0x02, 0x18, 0x08, 0x24, 0x70, 0x61, 0x49, 0xBD, 0xBE, 0xAE, 0xB2, 0xB5, 0xA6, 0xC1, 0xC3, 0xB8, 0x00, 0xAD, 0x00, 0xB0, 0x00, 0xE4};
    static u8 ams353_240[] = {0x02, 0x18, 0x08, 0x24, 0x78, 0x66, 0x4C, 0xBE, 0xBF, 0xB0, 0xB2, 0xB5, 0xA5, 0xC2, 0xC4, 0xBA, 0x00, 0xA9, 0x00, 0xAC, 0x00, 0xDE};
    static u8 ams353_230[] = {0x02, 0x18, 0x08, 0x24, 0x71, 0x61, 0x4A, 0xC0, 0xC0, 0xB1, 0xB2, 0xB5, 0xA6, 0xC2, 0xC4, 0xB9, 0x00, 0xA7, 0x00, 0xAA, 0x00, 0xDC};
    static u8 ams353_220[] = {0x02, 0x18, 0x08, 0x24, 0x73, 0x61, 0x4A, 0xBF, 0xC0, 0xB1, 0xB3, 0xB5, 0xA6, 0xC4, 0xC6, 0xBB, 0x00, 0xA3, 0x00, 0xA6, 0x00, 0xD7};
    static u8 ams353_210[] = {0x02, 0x18, 0x08, 0x24, 0x7A, 0x66, 0x4F, 0xC0, 0xC1, 0xB2, 0xB5, 0xB7, 0xA8, 0xC4, 0xC6, 0xBB, 0x00, 0x9F, 0x00, 0xA2, 0x00, 0xD2};
    static u8 ams353_200[] = {0x02, 0x18, 0x08, 0x24, 0x76, 0x61, 0x4B, 0xBF, 0xC0, 0xB2, 0xB5, 0xB8, 0xA8, 0xC4, 0xC6, 0xBB, 0x00, 0x9E, 0x00, 0xA0, 0x00, 0xD0};
    static u8 ams353_190[] = {0x02, 0x18, 0x08, 0x24, 0x78, 0x61, 0x4E, 0xBF, 0xC0, 0xB1, 0xB6, 0xB8, 0xA9, 0xC5, 0xC8, 0xBD, 0x00, 0x9A, 0x00, 0x9C, 0x00, 0xCA};
    static u8 ams353_180[] = {0x02, 0x18, 0x08, 0x24, 0x7E, 0x66, 0x54, 0xC2, 0xC2, 0xB3, 0xB6, 0xB9, 0xAA, 0xC7, 0xC9, 0xBE, 0x00, 0x95, 0x00, 0x97, 0x00, 0xC4};
    static u8 ams353_170[] = {0x02, 0x18, 0x08, 0x24, 0x79, 0x61, 0x4F, 0xC2, 0xC2, 0xB4, 0xB6, 0xB9, 0xA9, 0xC7, 0xC9, 0xBE, 0x00, 0x93, 0x00, 0x95, 0x00, 0xC2};
    static u8 ams353_160[] = {0x02, 0x18, 0x08, 0x24, 0x7D, 0x61, 0x52, 0xC0, 0xC1, 0xB2, 0xB9, 0xBB, 0xAC, 0xC8, 0xCA, 0xBF, 0x00, 0x8F, 0x00, 0x91, 0x00, 0xBD};
    static u8 ams353_150[] = {0x02, 0x18, 0x08, 0x24, 0x7D, 0x62, 0x4F, 0xC3, 0xC3, 0xB5, 0xBA, 0xBC, 0xAD, 0xC9, 0xCB, 0xC1, 0x00, 0x8A, 0x00, 0x8C, 0x00, 0xB5};
    static u8 ams353_140[] = {0x02, 0x18, 0x08, 0x24, 0x7E, 0x61, 0x53, 0xC3, 0xC3, 0xB6, 0xBA, 0xBC, 0xAC, 0xC9, 0xCB, 0xC1, 0x00, 0x88, 0x00, 0x8A, 0x00, 0xB3};                                              
    static u8 ams353_130[] = {0x02, 0x18, 0x08, 0x24, 0x78, 0x58, 0x4D, 0xC4, 0xC3, 0xB5, 0xBB, 0xBD, 0xAE, 0xCC, 0xCE, 0xC4, 0x00, 0x83, 0x00, 0x85, 0x00, 0xAD};
    static u8 ams353_120[] = {0x02, 0x18, 0x08, 0x24, 0x83, 0x62, 0x54, 0xC6, 0xC4, 0xB7, 0xBB, 0xBD, 0xAE, 0xCD, 0xCF, 0xC5, 0x00, 0x7E, 0x00, 0x80, 0x00, 0xA6};
    static u8 ams353_110[] = {0x02, 0x18, 0x08, 0x24, 0x7D, 0x58, 0x54, 0xC4, 0xC3, 0xB5, 0xBE, 0xBF, 0xB1, 0xCD, 0xCF, 0xC4, 0x00, 0x7B, 0x00, 0x7D, 0x00, 0xA3};
    static u8 ams353_100[] = {0x02, 0x18, 0x08, 0x24, 0x84, 0x58, 0x5A, 0xC4, 0xC3, 0xB6, 0xBD, 0xBF, 0xB0, 0xCF, 0xD1, 0xC6, 0x00, 0x77, 0x00, 0x78, 0x00, 0x9D};
    static u8 ams353_90[] = { 0x02, 0x18, 0x08, 0x24, 0x8C, 0x62, 0x60, 0xC7, 0xC5, 0xB8, 0xC0, 0xC1, 0xB3, 0xCF, 0xD1, 0xC6, 0x00, 0x71, 0x00, 0x72, 0x00, 0x95};
    static u8 ams353_80[] = { 0x02, 0x18, 0x08, 0x24, 0x89, 0x5A, 0x5D, 0xC7, 0xC5, 0xB8, 0xC1, 0xC2, 0xB4, 0xCF, 0xD1, 0xC6, 0x00, 0x6D, 0x00, 0x6E, 0x00, 0x90};
    static u8 ams353_70[] = { 0x02, 0x18, 0x08, 0x24, 0x8D, 0x5A, 0x63, 0xC8, 0xC5, 0xB8, 0xC2, 0xC4, 0xB6, 0xD2, 0xD3, 0xC9, 0x00, 0x67, 0x00, 0x68, 0x00, 0x88};
    static u8 ams353_60[] = { 0x02, 0x18, 0x08, 0x24, 0x95, 0x58, 0x72, 0xC7, 0xC3, 0xB7, 0xC3, 0xC4, 0xB6, 0xD4, 0xD5, 0xCB, 0x00, 0x62, 0x00, 0x63, 0x00, 0x82};
    static u8 ams353_50[] = { 0x02, 0x18, 0x08, 0x24, 0x8A, 0x46, 0x60, 0xCD, 0xC7, 0xBD, 0xC4, 0xC5, 0xB7, 0xD5, 0xD7, 0xCD, 0x00, 0x5B, 0x00, 0x5B, 0x00, 0x78}; 
    static u8 ams353_40[] = { 0x02, 0x18, 0x08, 0x24, 0x98, 0x6B, 0x8B, 0xCE, 0xBC, 0xBE, 0xC5, 0xC6, 0xB9, 0xD9, 0xD9, 0xD0, 0x00, 0x53, 0x00, 0x54, 0x00, 0x6F};
    static u8 ams353_30[] = { 0x02, 0x18, 0x08, 0x24, 0xA1, 0x6B, 0x9A, 0xD2, 0xBB, 0xC2, 0xC7, 0xC8, 0xBB, 0xDA, 0xDA, 0xD1, 0x00, 0x4B, 0x00, 0x4B, 0x00, 0x64};

    // 1.9 gamma                                                
    static u8 ams353_19_300[] = {0x02, 0x18, 0x08, 0x24, 0x76, 0x73, 0x53, 0xC1, 0xC2, 0xB4, 0xB5, 0xB8, 0xAA, 0xC4, 0xC6, 0xBD, 0x00, 0xBA, 0x00, 0xBE, 0x00, 0xF4};
    static u8 ams353_19_290[] = {0x02, 0x18, 0x08, 0x24, 0x6D, 0x77, 0x57, 0xC3, 0xC1, 0xB3, 0xB5, 0xB8, 0xA9, 0xC6, 0xC7, 0xBE, 0x00, 0xB8, 0x00, 0xBC, 0x00, 0xF3};
    static u8 ams353_19_280[] = {0x02, 0x18, 0x08, 0x24, 0x6F, 0x77, 0x58, 0xC3, 0xC1, 0xB2, 0xB6, 0xB9, 0xAB, 0xC6, 0xC7, 0xBE, 0x00, 0xB5, 0x00, 0xB9, 0x00, 0xEF};
    static u8 ams353_19_270[] = {0x02, 0x18, 0x08, 0x24, 0x76, 0x74, 0x53, 0xC2, 0xC3, 0xB5, 0xB7, 0xB9, 0xAB, 0xC7, 0xC9, 0xC0, 0x00, 0xB1, 0x00, 0xB5, 0x00, 0xE9};
    static u8 ams353_19_260[] = {0x02, 0x18, 0x08, 0x24, 0x7A, 0x77, 0x58, 0xC1, 0xC2, 0xB4, 0xB7, 0xBA, 0xAB, 0xC7, 0xC9, 0xC0, 0x00, 0xB0, 0x00, 0xB3, 0x00, 0xE8};
    static u8 ams353_19_250[] = {0x02, 0x18, 0x08, 0x24, 0x78, 0x75, 0x56, 0xC2, 0xC3, 0xB5, 0xB7, 0xBA, 0xAB, 0xC8, 0xCA, 0xC1, 0x00, 0xAD, 0x00, 0xB0, 0x00, 0xE4};
    static u8 ams353_19_240[] = {0x02, 0x18, 0x08, 0x24, 0x7D, 0x78, 0x5B, 0xC2, 0xC4, 0xB5, 0xB9, 0xBB, 0xAD, 0xC8, 0xCA, 0xC1, 0x00, 0xA9, 0x00, 0xAC, 0x00, 0xDE};
    static u8 ams353_19_230[] = {0x02, 0x18, 0x08, 0x24, 0x7B, 0x75, 0x56, 0xC2, 0xC4, 0xB6, 0xB9, 0xBB, 0xAD, 0xC9, 0xCB, 0xC1, 0x00, 0xA7, 0x00, 0xAA, 0x00, 0xDD};
    static u8 ams353_19_220[] = {0x02, 0x18, 0x08, 0x24, 0x7C, 0x75, 0x59, 0xC2, 0xC4, 0xB5, 0xBA, 0xBC, 0xAE, 0xC9, 0xCB, 0xC2, 0x00, 0xA4, 0x00, 0xA7, 0x00, 0xD8};
    static u8 ams353_19_210[] = {0x02, 0x18, 0x08, 0x24, 0x7E, 0x78, 0x5B, 0xC4, 0xC5, 0xB7, 0xBA, 0xBC, 0xAE, 0xCB, 0xCD, 0xC3, 0x00, 0x9F, 0x00, 0xA2, 0x00, 0xD2};
    static u8 ams353_19_200[] = {0x02, 0x18, 0x08, 0x24, 0x7C, 0x75, 0x58, 0xC4, 0xC5, 0xB7, 0xBC, 0xBE, 0xB0, 0xC9, 0xCC, 0xC2, 0x00, 0x9E, 0x00, 0xA0, 0x00, 0xD0};
    static u8 ams353_19_190[] = {0x02, 0x18, 0x08, 0x24, 0x7E, 0x77, 0x5A, 0xC4, 0xC5, 0xB7, 0xBC, 0xBE, 0xB0, 0xCB, 0xCE, 0xC4, 0x00, 0x9A, 0x00, 0x9C, 0x00, 0xCB};
    static u8 ams353_19_180[] = {0x02, 0x18, 0x08, 0x24, 0x80, 0x78, 0x5B, 0xC7, 0xC7, 0xBA, 0xBC, 0xBE, 0xB0, 0xCD, 0xD0, 0xC6, 0x00, 0x95, 0x00, 0x97, 0x00, 0xC4};
    static u8 ams353_19_170[] = {0x02, 0x18, 0x08, 0x24, 0x80, 0x77, 0x5B, 0xC5, 0xC7, 0xB9, 0xBD, 0xBF, 0xB1, 0xCD, 0xCF, 0xC5, 0x00, 0x93, 0x00, 0x95, 0x00, 0xC2};
    static u8 ams353_19_160[] = {0x02, 0x18, 0x08, 0x24, 0x80, 0x77, 0x5B, 0xC7, 0xC8, 0xBB, 0xBD, 0xBF, 0xB1, 0xCF, 0xD1, 0xC8, 0x00, 0x8F, 0x00, 0x91, 0x00, 0xBC};
    static u8 ams353_19_150[] = {0x02, 0x18, 0x08, 0x24, 0x82, 0x79, 0x5C, 0xC8, 0xC8, 0xBB, 0xBF, 0xC1, 0xB4, 0xD0, 0xD2, 0xC9, 0x00, 0x8A, 0x00, 0x8C, 0x00, 0xB5};
    static u8 ams353_19_140[] = {0x02, 0x18, 0x08, 0x24, 0x81, 0x77, 0x5F, 0xC8, 0xC8, 0xBB, 0xC0, 0xC2, 0xB4, 0xCF, 0xD1, 0xC8, 0x00, 0x88, 0x00, 0x8A, 0x00, 0xB3};
    static u8 ams353_19_130[] = {0x02, 0x18, 0x08, 0x24, 0x84, 0x77, 0x60, 0xC8, 0xC8, 0xBB, 0xC0, 0xC3, 0xB5, 0xD1, 0xD2, 0xC8, 0x00, 0x84, 0x00, 0x86, 0x00, 0xAF};
    static u8 ams353_19_120[] = {0x02, 0x18, 0x08, 0x24, 0x87, 0x79, 0x61, 0xC9, 0xC9, 0xBC, 0xC3, 0xC4, 0xB7, 0xD2, 0xD4, 0xCB, 0x00, 0x7E, 0x00, 0x80, 0x00, 0xA6};
    static u8 ams353_19_110[] = {0x02, 0x18, 0x08, 0x24, 0x85, 0x77, 0x61, 0xC9, 0xC9, 0xBC, 0xC3, 0xC5, 0xB7, 0xD3, 0xD4, 0xCB, 0x00, 0x7B, 0x00, 0x7D, 0x00, 0xA3};
    static u8 ams353_19_100[] = {0x02, 0x18, 0x08, 0x24, 0x89, 0x77, 0x65, 0xCA, 0xCA, 0xBD, 0xC3, 0xC5, 0xB7, 0xD4, 0xD6, 0xCD, 0x00, 0x77, 0x00, 0x78, 0x00, 0x9D};
    static u8 ams353_19_90[] = { 0x02, 0x18, 0x08, 0x24, 0x8E, 0x79, 0x68, 0xCB, 0xCB, 0xBE, 0xC6, 0xC7, 0xBB, 0xD5, 0xD7, 0xCD, 0x00, 0x71, 0x00, 0x72, 0x00, 0x95};
    static u8 ams353_19_80[] = { 0x02, 0x18, 0x08, 0x24, 0x8F, 0x77, 0x6A, 0xCB, 0xCB, 0xBE, 0xC5, 0xC6, 0xB9, 0xD7, 0xD9, 0xD0, 0x00, 0x6D, 0x00, 0x6E, 0x00, 0x90};
    static u8 ams353_19_70[] = { 0x02, 0x18, 0x08, 0x24, 0x92, 0x77, 0x6D, 0xCC, 0xCB, 0xBF, 0xC7, 0xC8, 0xBB, 0xD7, 0xD9, 0xCF, 0x00, 0x68, 0x00, 0x69, 0x00, 0x8A};
    static u8 ams353_19_60[] = { 0x02, 0x18, 0x08, 0x24, 0x93, 0x77, 0x6E, 0xCE, 0xCC, 0xC1, 0xC8, 0xCA, 0xBD, 0xD8, 0xDA, 0xD1, 0x00, 0x63, 0x00, 0x63, 0x00, 0x82};
    static u8 ams353_19_50[] = { 0x02, 0x18, 0x08, 0x24, 0x96, 0x77, 0x75, 0xD0, 0xCD, 0xC2, 0xC9, 0xCA, 0xBE, 0xDA, 0xDC, 0xD3, 0x00, 0x5C, 0x00, 0x5C, 0x00, 0x79};
    static u8 ams353_19_40[] = { 0x02, 0x18, 0x08, 0x24, 0x93, 0x77, 0x72, 0xCF, 0xD0, 0xC5, 0xCB, 0xCF, 0xC1, 0xDD, 0xE0, 0xD6, 0x00, 0x5B, 0x00, 0x5A, 0x00, 0x7A}; 
    static u8 ams353_19_30[] = { 0x02, 0x18, 0x08, 0x24, 0x9D, 0x75, 0x7C, 0xD0, 0xD0, 0xC6, 0xCD, 0xD1, 0xC3, 0xDE, 0xE1, 0xD8, 0x00, 0x53, 0x00, 0x52, 0x00, 0x6F};
#endif
    // 1.7 gamma
    static u8 ams353_17_300[] = {0x02, 0x18, 0x08, 0x24, 0x7C, 0x7C, 0x5B, 0xC3, 0xC5, 0xB8, 0xBA, 0xBC, 0xAF, 0xC9, 0xCB, 0xC3, 0x00, 0xBA, 0x00, 0xBE, 0x00, 0xF4};
    static u8 ams353_17_285[] = {0x02, 0x18, 0x08, 0x24, 0x7D, 0x7E, 0x5E, 0xC4, 0xC5, 0xB8, 0xBB, 0xBD, 0xB0, 0xCA, 0xCC, 0xC3, 0x00, 0xB6, 0x00, 0xBA, 0x00, 0xF0};
    static u8 ams353_17_270[] = {0x02, 0x18, 0x08, 0x24, 0x7E, 0x7F, 0x5D, 0xC5, 0xC6, 0xB9, 0xBB, 0xBD, 0xB0, 0xCC, 0xCE, 0xC6, 0x00, 0xB1, 0x00, 0xB5, 0x00, 0xE9};
    static u8 ams353_17_255[] = {0x02, 0x18, 0x08, 0x24, 0x7F, 0x80, 0x5F, 0xC6, 0xC7, 0xBA, 0xBB, 0xBE, 0xB1, 0xCB, 0xCC, 0xC3, 0x00, 0xAE, 0x00, 0xB2, 0x00, 0xE6};
    static u8 ams353_17_240[] = {0x02, 0x18, 0x08, 0x24, 0x80, 0x80, 0x60, 0xC7, 0xC8, 0xBB, 0xBD, 0xBF, 0xB2, 0xCC, 0xCF, 0xC6, 0x00, 0xA9, 0x00, 0xAC, 0x00, 0xDE};
    static u8 ams353_17_225[] = {0x02, 0x18, 0x08, 0x24, 0x81, 0x81, 0x62, 0xC7, 0xC8, 0xBB, 0xBE, 0xC0, 0xB3, 0xCE, 0xD0, 0xC7, 0x00, 0xA4, 0x00, 0xA7, 0x00, 0xD8};
    static u8 ams353_17_210[] = {0x02, 0x18, 0x08, 0x24, 0x82, 0x81, 0x62, 0xC8, 0xC9, 0xBC, 0xBE, 0xC1, 0xB4, 0xD0, 0xD1, 0xC8, 0x00, 0x9F, 0x00, 0xA2, 0x00, 0xD2};
    static u8 ams353_17_195[] = {0x02, 0x18, 0x08, 0x24, 0x83, 0x82, 0x64, 0xC9, 0xCA, 0xBD, 0xC0, 0xC2, 0xB5, 0xD0, 0xD2, 0xC9, 0x00, 0x9A, 0x00, 0x9D, 0x00, 0xCB};
    static u8 ams353_17_180[] = {0x02, 0x18, 0x08, 0x24, 0x86, 0x82, 0x65, 0xC9, 0xCB, 0xBE, 0xC1, 0xC3, 0xB6, 0xD1, 0xD3, 0xCA, 0x00, 0x95, 0x00, 0x97, 0x00, 0xC4};
    static u8 ams353_17_165[] = {0x02, 0x18, 0x08, 0x24, 0x88, 0x84, 0x68, 0xC9, 0xCA, 0xBD, 0xC3, 0xC5, 0xB8, 0xD2, 0xD4, 0xCC, 0x00, 0x90, 0x00, 0x92, 0x00, 0xBD};
    static u8 ams353_17_150[] = {0x02, 0x18, 0x08, 0x24, 0x8A, 0x84, 0x67, 0xCB, 0xCC, 0xC0, 0xC3, 0xC5, 0xB8, 0xD4, 0xD6, 0xCE, 0x00, 0x8A, 0x00, 0x8C, 0x00, 0xB5};
    static u8 ams353_17_135[] = {0x02, 0x18, 0x08, 0x24, 0x8A, 0x85, 0x68, 0xCC, 0xCD, 0xC1, 0xC5, 0xC6, 0xBA, 0xD5, 0xD7, 0xCE, 0x00, 0x84, 0x00, 0x86, 0x00, 0xAE};
    static u8 ams353_17_120[] = {0x02, 0x18, 0x08, 0x24, 0x8F, 0x87, 0x6D, 0xCC, 0xCD, 0xC1, 0xC6, 0xC8, 0xBB, 0xD7, 0xD8, 0xD0, 0x00, 0x7E, 0x00, 0x80, 0x00, 0xA6};
    static u8 ams353_17_105[] = {0x02, 0x18, 0x08, 0x24, 0x8F, 0x87, 0x6D, 0xCD, 0xCD, 0xC1, 0xC8, 0xCA, 0xBE, 0xD9, 0xDA, 0xD2, 0x00, 0x77, 0x00, 0x79, 0x00, 0x9D};
    static u8 ams353_17_90[]  = {0x02, 0x18, 0x08, 0x24, 0x90, 0x87, 0x6E, 0xCF, 0xCF, 0xC4, 0xCA, 0xCB, 0xBF, 0xD9, 0xDB, 0xD2, 0x00, 0x71, 0x00, 0x72, 0x00, 0x95};

#else 
    // 2.2 gamma
    static u8 ams353_300[] = {0x02, 0x18, 0x08, 0x24, 0x73, 0x74, 0x5A, 0xC1, 0xC4, 0xB3, 0xB4, 0xB8, 0xA5, 0xC9, 0xCC, 0xBC, 0x00, 0xB1, 0x00, 0xAB, 0x00, 0xF4};
    static u8 ams353_285[] = {0x02, 0x18, 0x08, 0x24, 0x77, 0x74, 0x5C, 0xC0, 0xC4, 0xB3, 0xB5, 0xB9, 0xA6, 0xC9, 0xCC, 0xBB, 0x00, 0xAE, 0x00, 0xA8, 0x00, 0xF1};
    static u8 ams353_270[] = {0x02, 0x18, 0x08, 0x24, 0x76, 0x74, 0x5C, 0xC1, 0xC4, 0xB4, 0xB5, 0xB9, 0xA6, 0xC9, 0xCC, 0xBC, 0x00, 0xAB, 0x00, 0xA5, 0x00, 0xEB};
    static u8 ams353_255[] = {0x02, 0x18, 0x08, 0x24, 0x76, 0x74, 0x5C, 0xC3, 0xC6, 0xB6, 0xB5, 0xB9, 0xA6, 0xC9, 0xCC, 0xBC, 0x00, 0xA9, 0x00, 0xA3, 0x00, 0xE8};
    static u8 ams353_240[] = {0x02, 0x18, 0x08, 0x24, 0x76, 0x74, 0x5C, 0xC3, 0xC6, 0xB6, 0xB8, 0xBC, 0xAA, 0xC7, 0xCB, 0xBB, 0x00, 0xA7, 0x00, 0xA0, 0x00, 0xE3};
    static u8 ams353_225[] = {0x02, 0x18, 0x08, 0x24, 0x78, 0x74, 0x5F, 0xC3, 0xC6, 0xB6, 0xB9, 0xBD, 0xAB, 0xC8, 0xCB, 0xBC, 0x00, 0xA3, 0x00, 0x9D, 0x00, 0xDD};
    static u8 ams353_210[] = {0x02, 0x18, 0x08, 0x24, 0x79, 0x74, 0x5F, 0xC4, 0xC7, 0xB8, 0xB8, 0xBD, 0xAA, 0xC8, 0xCB, 0xBC, 0x00, 0xA0, 0x00, 0x99, 0x00, 0xD8};
    static u8 ams353_195[] = {0x02, 0x18, 0x08, 0x24, 0x7B, 0x76, 0x63, 0xC4, 0xC7, 0xB7, 0xBA, 0xBE, 0xAC, 0xCA, 0xCD, 0xBF, 0x00, 0x9B, 0x00, 0x95, 0x00, 0xD1};
    static u8 ams353_180[] = {0x02, 0x18, 0x08, 0x24, 0x7D, 0x76, 0x66, 0xC4, 0xC7, 0xB7, 0xBB, 0xBF, 0xAD, 0xCB, 0xCE, 0xC0, 0x00, 0x96, 0x00, 0x90, 0x00, 0xCA};
    static u8 ams353_165[] = {0x02, 0x18, 0x08, 0x24, 0x7E, 0x76, 0x66, 0xC4, 0xC7, 0xB8, 0xBC, 0xC0, 0xAE, 0xCC, 0xCE, 0xC0, 0x00, 0x92, 0x00, 0x8C, 0x00, 0xC4};
    static u8 ams353_150[] = {0x02, 0x18, 0x08, 0x24, 0x7F, 0x76, 0x68, 0xC6, 0xC7, 0xB9, 0xBE, 0xC2, 0xB1, 0xCC, 0xD0, 0xC2, 0x00, 0x8C, 0x00, 0x86, 0x00, 0xBB};
    static u8 ams353_135[] = {0x02, 0x18, 0x08, 0x24, 0x85, 0x76, 0x6D, 0xC4, 0xC7, 0xB8, 0xBF, 0xC2, 0xB1, 0xCE, 0xD2, 0xC5, 0x00, 0x87, 0x00, 0x81, 0x00, 0xB4};
    static u8 ams353_120[] = {0x02, 0x18, 0x08, 0x24, 0x85, 0x76, 0x6D, 0xC9, 0xCB, 0xBE, 0xBE, 0xC2, 0xB0, 0xCE, 0xD2, 0xC5, 0x00, 0x82, 0x00, 0x7C, 0x00, 0xAD};
    static u8 ams353_105[] = {0x02, 0x18, 0x08, 0x24, 0x86, 0x76, 0x6F, 0xC9, 0xCB, 0xBE, 0xC3, 0xC6, 0xB6, 0xD1, 0xD4, 0xC7, 0x00, 0x7B, 0x00, 0x76, 0x00, 0xA4};
    static u8 ams353_90[] = {0x02, 0x18, 0x08, 0x24, 0x88, 0x76, 0x73, 0xCB, 0xCB, 0xBF, 0xC2, 0xC6, 0xB6, 0xD2, 0xD5, 0xC8, 0x00, 0x76, 0x00, 0x71, 0x00, 0x9D};
    static u8 ams353_80[] = {0x02, 0x18, 0x08, 0x24, 0x89, 0x5A, 0x5D, 0xC7, 0xC5, 0xB8, 0xC1, 0xC2, 0xB4, 0xCF, 0xD1, 0xC6, 0x00, 0x6D, 0x00, 0x6E, 0x00, 0x90};
    static u8 ams353_70[] = {0x02, 0x18, 0x08, 0x24, 0x8D, 0x5A, 0x63, 0xC8, 0xC5, 0xB8, 0xC2, 0xC4, 0xB6, 0xD2, 0xD3, 0xC9, 0x00, 0x67, 0x00, 0x68, 0x00, 0x88};
    static u8 ams353_50[] = {0x02, 0x18, 0x08, 0x24, 0x9E, 0x67, 0x78, 0xCC, 0xC7, 0xBC, 0xC5, 0xC6, 0xB9, 0xD3, 0xD5, 0xCA, 0x00, 0x5D, 0x00, 0x5D, 0x00, 0x7A};

    // 1.9 gamma
    static u8 ams353_19_300[] = {0x02, 0x18, 0x08, 0x24, 0x7D, 0x80, 0x60, 0xC4, 0xC8, 0xB8, 0xBA, 0xBE, 0xAC, 0xD0, 0xD2, 0xC4, 0x00, 0xB1, 0x00, 0xAB, 0x00, 0xF4};
    static u8 ams353_19_285[] = {0x02, 0x18, 0x08, 0x24, 0x7D, 0x80, 0x60, 0xC4, 0xC8, 0xB8, 0xBA, 0xBE, 0xAC, 0xD1, 0xD3, 0xC4, 0x00, 0xAE, 0x00, 0xA8, 0x00, 0xF1};
    static u8 ams353_19_270[] = {0x02, 0x18, 0x08, 0x24, 0x7D, 0x81, 0x61, 0xC5, 0xC8, 0xB8, 0xBC, 0xC0, 0xAF, 0xD0, 0xD3, 0xC4, 0x00, 0xAB, 0x00, 0xA5, 0x00, 0xEB};
    static u8 ams353_19_255[] = {0x02, 0x18, 0x08, 0x24, 0x80, 0x83, 0x65, 0xC5, 0xC9, 0xB9, 0xBD, 0xC0, 0xAF, 0xCF, 0xD2, 0xC3, 0x00, 0xA9, 0x00, 0xA3, 0x00, 0xE8};
    static u8 ams353_19_240[] = {0x02, 0x18, 0x08, 0x24, 0x82, 0x85, 0x67, 0xC6, 0xC9, 0xBA, 0xBD, 0xC1, 0xAF, 0xCE, 0xD2, 0xC4, 0x00, 0xA7, 0x00, 0xA0, 0x00, 0xE3};
    static u8 ams353_19_225[] = {0x02, 0x18, 0x08, 0x24, 0x84, 0x86, 0x6A, 0xC6, 0xC9, 0xB9, 0xBE, 0xC2, 0xB1, 0xCF, 0xD2, 0xC5, 0x00, 0xA3, 0x00, 0x9D, 0x00, 0xDD};
    static u8 ams353_19_210[] = {0x02, 0x18, 0x08, 0x24, 0x84, 0x86, 0x6A, 0xC8, 0xCB, 0xBC, 0xBF, 0xC3, 0xB2, 0xCE, 0xD2, 0xC4, 0x00, 0xA0, 0x00, 0x99, 0x00, 0xD8};
    static u8 ams353_19_195[] = {0x02, 0x18, 0x08, 0x24, 0x85, 0x86, 0x69, 0xC8, 0xCB, 0xBD, 0xC0, 0xC4, 0xB2, 0xD0, 0xD3, 0xC7, 0x00, 0x9B, 0x00, 0x95, 0x00, 0xD1};
    static u8 ams353_19_180[] = {0x02, 0x18, 0x08, 0x24, 0x86, 0x86, 0x6B, 0xC9, 0xCC, 0xBE, 0xC1, 0xC5, 0xB4, 0xD1, 0xD4, 0xC7, 0x00, 0x96, 0x00, 0x90, 0x00, 0xCA};
    static u8 ams353_19_165[] = {0x02, 0x18, 0x08, 0x24, 0x88, 0x86, 0x6F, 0xC9, 0xCC, 0xBD, 0xC1, 0xC5, 0xB5, 0xD2, 0xD5, 0xC8, 0x00, 0x92, 0x00, 0x8C, 0x00, 0xC4};
    static u8 ams353_19_150[] = {0x02, 0x18, 0x08, 0x24, 0x87, 0x86, 0x6F, 0xCB, 0xCD, 0xBF, 0xC3, 0xC7, 0xB6, 0xD3, 0xD6, 0xCB, 0x00, 0x8C, 0x00, 0x86, 0x00, 0xBB};
    static u8 ams353_19_135[] = {0x02, 0x18, 0x08, 0x24, 0x88, 0x86, 0x6F, 0xCC, 0xCE, 0xC1, 0xC4, 0xC8, 0xB8, 0xD4, 0xD7, 0xCB, 0x00, 0x87, 0x00, 0x81, 0x00, 0xB4};
    static u8 ams353_19_120[] = {0x02, 0x18, 0x08, 0x24, 0x8A, 0x87, 0x72, 0xCC, 0xCE, 0xC1, 0xC6, 0xC9, 0xB9, 0xD4, 0xD8, 0xCC, 0x00, 0x82, 0x00, 0x7C, 0x00, 0xAD};
    static u8 ams353_19_105[] = {0x02, 0x18, 0x08, 0x24, 0x8F, 0x87, 0x77, 0xCC, 0xCE, 0xC1, 0xC6, 0xCA, 0xBA, 0xD7, 0xD9, 0xCE, 0x00, 0x7B, 0x00, 0x76, 0x00, 0xA4};
    static u8 ams353_19_90[] = {0x02, 0x18, 0x08, 0x24, 0x8E, 0x87, 0x79, 0xD0, 0xD1, 0xC5, 0xC6, 0xCA, 0xBA, 0xD7, 0xD9, 0xCE, 0x00, 0x76, 0x00, 0x71, 0x00, 0x9D};

    // 1.7 gamma
    static u8 ams353_17_300[] = {0x02, 0x18, 0x08, 0x24, 0x84, 0x8A, 0x6B, 0xC6, 0xC9, 0xB9, 0xBF, 0xC3, 0xB2, 0xD4, 0xD6, 0xC9, 0x00, 0xB1, 0x00, 0xAB, 0x00, 0xF4};
    static u8 ams353_17_285[] = {0x02, 0x18, 0x08, 0x24, 0x83, 0x8A, 0x6A, 0xC6, 0xC9, 0xB9, 0xBF, 0xC3, 0xB3, 0xD5, 0xD7, 0xC8, 0x00, 0xAE, 0x00, 0xA8, 0x00, 0xF1};
    static u8 ams353_17_270[] = {0x02, 0x18, 0x08, 0x24, 0x84, 0x8A, 0x6A, 0xC7, 0xCB, 0xBB, 0xC1, 0xC5, 0xB4, 0xD4, 0xD6, 0xC9, 0x00, 0xAB, 0x00, 0xA5, 0x00, 0xEB};
    static u8 ams353_17_255[] = {0x02, 0x18, 0x08, 0x24, 0x84, 0x8A, 0x6A, 0xC9, 0xCC, 0xBD, 0xC0, 0xC4, 0xB3, 0xD4, 0xD6, 0xC9, 0x00, 0xA9, 0x00, 0xA3, 0x00, 0xE8};
    static u8 ams353_17_240[] = {0x02, 0x18, 0x08, 0x24, 0x87, 0x8A, 0x6C, 0xC8, 0xCC, 0xBD, 0xC2, 0xC6, 0xB5, 0xD2, 0xD5, 0xC8, 0x00, 0xA7, 0x00, 0xA0, 0x00, 0xE3};
    static u8 ams353_17_225[] = {0x02, 0x18, 0x08, 0x24, 0x87, 0x8C, 0x6E, 0xC9, 0xCC, 0xBD, 0xC3, 0xC6, 0xB6, 0xD3, 0xD6, 0xCA, 0x00, 0xA3, 0x00, 0x9D, 0x00, 0xDD};
    static u8 ams353_17_210[] = {0x02, 0x18, 0x08, 0x24, 0x87, 0x8D, 0x6E, 0xCB, 0xCE, 0xC0, 0xC4, 0xC7, 0xB7, 0xD1, 0xD5, 0xC8, 0x00, 0xA0, 0x00, 0x99, 0x00, 0xD8};
    static u8 ams353_17_195[] = {0x02, 0x18, 0x08, 0x24, 0x89, 0x8F, 0x71, 0xCB, 0xCE, 0xC0, 0xC5, 0xC8, 0xB8, 0xD3, 0xD6, 0xCA, 0x00, 0x9B, 0x00, 0x95, 0x00, 0xD1};
    static u8 ams353_17_180[] = {0x02, 0x18, 0x08, 0x24, 0x8A, 0x8F, 0x70, 0xCB, 0xCE, 0xC0, 0xC6, 0xC9, 0xBA, 0xD5, 0xD8, 0xCC, 0x00, 0x96, 0x00, 0x90, 0x00, 0xCA};
    static u8 ams353_17_165[] = {0x02, 0x18, 0x08, 0x24, 0x8B, 0x8F, 0x72, 0xCB, 0xCE, 0xC0, 0xC7, 0xCA, 0xBB, 0xD5, 0xD8, 0xCC, 0x00, 0x92, 0x00, 0x8C, 0x00, 0xC4};
    static u8 ams353_17_150[] = {0x02, 0x18, 0x08, 0x24, 0x8C, 0x8F, 0x72, 0xCD, 0xD0, 0xC3, 0xC8, 0xCB, 0xBB, 0xD7, 0xDA, 0xD0, 0x00, 0x8C, 0x00, 0x86, 0x00, 0xBB};
    static u8 ams353_17_135[] = {0x02, 0x18, 0x08, 0x24, 0x8E, 0x8F, 0x75, 0xCE, 0xD1, 0xC4, 0xC8, 0xCB, 0xBB, 0xD8, 0xDB, 0xD1, 0x00, 0x87, 0x00, 0x81, 0x00, 0xB4};
    static u8 ams353_17_120[] = {0x02, 0x18, 0x08, 0x24, 0x8E, 0x8F, 0x77, 0xD0, 0xD2, 0xC5, 0xC9, 0xCD, 0xBD, 0xD8, 0xDB, 0xD1, 0x00, 0x82, 0x00, 0x7C, 0x00, 0xAD};
    static u8 ams353_17_105[] = {0x02, 0x18, 0x08, 0x24, 0x8E, 0x8F, 0x77, 0xD2, 0xD3, 0xC7, 0xC9, 0xCD, 0xBE, 0xDB, 0xDD, 0xD3, 0x00, 0x7B, 0x00, 0x76, 0x00, 0xA4};
    static u8 ams353_17_90[] = {0x02, 0x18, 0x08, 0x24, 0x8F, 0x8F, 0x77, 0xD1, 0xD3, 0xC7, 0xCD, 0xD0, 0xC2, 0xDB, 0xDD, 0xD3, 0x00, 0x76, 0x00, 0x71, 0x00, 0x9D};

#endif //LCD_AR3_GAMMA

    int cd[16] = {50, 70, 80, 90, 105, 120, 135, 150, 165, 180, 195, 210, 225, 240, 270, 300}; //ams353


	
void ams353_gamma_ctl(u8 *gamma);


/*  Manual
 * defines HFB, HSW, HBP, VFP, VSW, VBP as shown below
 */

static struct omap_video_timings ams353_panel_timings = {
	/* 800 x 480 @ 60 Hz  Reduced blanking VESA CVT 0.31M3-R */
	.x_res          = LCD_XRES,
	.y_res          = LCD_YRES,
	.pixel_clock    = LCD_PIXCLOCK_MAX,
	.hfp            = LCD_HFP,
	.hsw            = LCD_HSW,
	.hbp            = LCD_HBP,
	.vfp            = LCD_VFP,
	.vsw            = LCD_VSW,
	.vbp            = LCD_VBP,
};

static int ams353_panel_probe(struct omap_dss_device *dssdev)
{
	int ret;

	printk(KERN_INFO "[LCD] ams353_panel_probe.\n");
	dssdev->panel.config = OMAP_DSS_LCD_TFT | OMAP_DSS_LCD_IVS |OMAP_DSS_LCD_IEO |OMAP_DSS_LCD_IPC |
						OMAP_DSS_LCD_IHS | OMAP_DSS_LCD_ONOFF ;
	
    //dssdev->panel.recommended_bpp= 32;
	dssdev->panel.acb = 0;
	dssdev->panel.timings = ams353_panel_timings;

#ifdef TEST_LCD_SUSPEND
	wake_lock_init( &lcd_wakelock, WAKE_LOCK_SUSPEND, "ams353_panel");
	wake_lock( &lcd_wakelock);
#endif

	ret = gpio_request(OMAP_GPIO_MLCD_RST, "MLCD_RST");
	if (ret < 0) {
                printk(KERN_ERR "%s: can't reserve GPIO: %d\n", __func__,
                        OMAP_GPIO_MLCD_RST);
		return -1;
	}
	gpio_direction_output(OMAP_GPIO_MLCD_RST, 1);

	vaux4 = regulator_get( &dssdev->dev, "vaux4" );
	if( IS_ERR( vaux4 ) )
		printk( "Fail to register vaux4 using regulator framework!\n" );	

	vaux3 = regulator_get( &dssdev->dev, "vaux3" );
	if( IS_ERR( vaux3 ) )
		printk( "Fail to register vaux3 using regulator framework!\n" );	

	vpll2 = regulator_get( &dssdev->dev, "vpll2" );
	if( IS_ERR( vpll2 ) )
		printk( "Fail to register vpll2 using regulator framework!\n" );	

	ams353_lcd_LDO_on();

	//MLCD pin set to InputPulldown.
	omap_ctrl_writew(0x010C, 0x1c6);

	return 0;
}

static void ams353_panel_remove(struct omap_dss_device *dssdev)
{
	regulator_put( vaux4 );
	regulator_put( vaux3 );
	regulator_put( vpll2 );
}

static int ams353_panel_enable(struct omap_dss_device *dssdev)
{
	int r = 0;
	mdelay(4);
	if (dssdev->platform_enable)
		r = dssdev->platform_enable(dssdev);

        if (dssdev->state != OMAP_DSS_DISPLAY_DISABLED) {
                r = -EINVAL;
                goto err;
        }


        dssdev->state = OMAP_DSS_DISPLAY_ACTIVE;

err:
	return r;
}

static void ams353_panel_disable(struct omap_dss_device *dssdev)
{
	if (dssdev->platform_disable)
		dssdev->platform_disable(dssdev);
	mdelay(4);

        if (dssdev->state == OMAP_DSS_DISPLAY_DISABLED)
                goto end;

        if (dssdev->state == OMAP_DSS_DISPLAY_SUSPENDED) {
                printk(KERN_WARNING "[LCD] ams353_panel_disabled - called when panel is in suspend\n");
                goto end;
        }

        dssdev->state = OMAP_DSS_DISPLAY_DISABLED;

end:
	return;

}

static int ams353_panel_suspend(struct omap_dss_device *dssdev)
{
	printk(KERN_INFO "[LCD] ams353_panel_suspend\n");
	spi_setup(ams353lcd_spi);
	ams353_lcd_poweroff();
    
    #ifdef LCD_REFRESH_CHANGE
	if ( refresh_rate == OMAP_DSS_FR_60HZ)
	{
		reduce_refresh_rate(1);
		refresh_rate = OMAP_DSS_FR_52HZ_SUSPEND;
		refresh_count = 10;
	}
    #endif
    
    dssdev->state = OMAP_DSS_DISPLAY_SUSPENDED;
    
	return 0;
}

static int ams353_panel_resume(struct omap_dss_device *dssdev)
{
	printk(KERN_INFO "[LCD] ams353_panel_resume\n");

	spi_setup(ams353lcd_spi);
	ams353_lcd_poweron();
    dssdev->state = OMAP_DSS_DISPLAY_ACTIVE;

	return 0;
}

static struct omap_dss_driver ams353_driver = {
	.probe          = ams353_panel_probe,
	.remove         = ams353_panel_remove,

	.enable         = ams353_panel_enable,
	.disable        = ams353_panel_disable,
	.suspend        = ams353_panel_suspend,
	.resume         = ams353_panel_resume,

	.driver		= {
		.name	= "ams353_panel",
		.owner 	= THIS_MODULE,
	},
};


void ams353_lcd_brightness_setting(int idx, int mode)
{
	// printk(KERN_INFO "[LCD] ams353_lcd_brightness_setting : %d, %d\n", idx, mode);
	
#ifndef LCD_ARIAN_GAMMA
	if ((idx > 15) || (idx < 0)) 
#else
	if ((idx > 27) || (idx < 0)) 
#endif
		idx = LCD_DEFAULT_BRIGHTNESS;

	if (mode == GAMMA_1_9) // 1.9 gamma
	{
		switch (idx)
		{
#ifndef LCD_ARIAN_GAMMA
			case	15 :	ams353_gamma_ctl(ams353_19_300);	break;
			case	14 :	ams353_gamma_ctl(ams353_19_285);	break;
			case	13 :	ams353_gamma_ctl(ams353_19_270);	break;
			case	12 :	ams353_gamma_ctl(ams353_19_255);	break;
			case	11 :	ams353_gamma_ctl(ams353_19_240);	break;
			case	10 :	ams353_gamma_ctl(ams353_19_225);	break;
			case	9  :	ams353_gamma_ctl(ams353_19_210);	break;
			case	8  :	ams353_gamma_ctl(ams353_19_195);	break;
			case	7  :	ams353_gamma_ctl(ams353_19_180);	break;
			case	6  :	ams353_gamma_ctl(ams353_19_165);	break;
			case	5  :	ams353_gamma_ctl(ams353_19_150);	break;
			case	4  :	ams353_gamma_ctl(ams353_19_135);	break;
			case	3  :	ams353_gamma_ctl(ams353_19_120);	break;
			case	2  :	ams353_gamma_ctl(ams353_19_105);	break;
			case	1  :	ams353_gamma_ctl(ams353_19_90);		break;
			case	0  :	ams353_gamma_ctl(ams353_50);		break;
#else
			case	27 :	ams353_gamma_ctl(ams353_19_300);	break;
			case	26 :	ams353_gamma_ctl(ams353_19_290);	break;
			case	25 :	ams353_gamma_ctl(ams353_19_280);	break;
			case	24 :	ams353_gamma_ctl(ams353_19_270);	break;
			case	23 :	ams353_gamma_ctl(ams353_19_260);	break;
			case	22 :	ams353_gamma_ctl(ams353_19_250);	break;
			case	21 :	ams353_gamma_ctl(ams353_19_240);	break;
			case	20 :	ams353_gamma_ctl(ams353_19_230);	break;
			case	19 :	ams353_gamma_ctl(ams353_19_220);	break;
			case	18 :	ams353_gamma_ctl(ams353_19_210);	break;
			case	17 :	ams353_gamma_ctl(ams353_19_200);	break;
			case	16 :	ams353_gamma_ctl(ams353_19_190);	break;
			case	15 :	ams353_gamma_ctl(ams353_19_180);	break;
			case	14 :	ams353_gamma_ctl(ams353_19_170);	break;
			case	13 :	ams353_gamma_ctl(ams353_19_160);	break;
			case	12 :	ams353_gamma_ctl(ams353_19_150);	break;
			case	11 :	ams353_gamma_ctl(ams353_19_140);	break;
			case	10 :	ams353_gamma_ctl(ams353_19_130);	break;
			case	9  :	ams353_gamma_ctl(ams353_19_120);	break;
			case	8  :	ams353_gamma_ctl(ams353_19_110);	break;
			case	7  :	ams353_gamma_ctl(ams353_19_100);	break;
			case	6  :	ams353_gamma_ctl(ams353_19_90);		break;
			case	5  :	ams353_gamma_ctl(ams353_19_80);		break;
			case	4  :	ams353_gamma_ctl(ams353_19_70);		break;
			case	3  :	ams353_gamma_ctl(ams353_19_60);		break;
			case	2  :	ams353_gamma_ctl(ams353_19_50);		break;
			case	1  :	ams353_gamma_ctl(ams353_19_40);		break;
			case	0  :	ams353_gamma_ctl(ams353_19_30);		break;
#endif		
		}
	}
	
	else 
	if (mode == GAMMA_1_7)	// 1.7 gamma
	{
		switch (idx)
		{
#ifdef LCD_ARIAN_GAMMA
			case	27 :
			case	26 :
			case	25 :
			case	24 :
			case	23 :
			case	22 :
			case	21 :
			case	20 :
			case	19 :
			case	18 :
			case	17 :
			case	16 :
#endif				
			case	15 :	ams353_gamma_ctl(ams353_17_300);	break;
			case	14 :	ams353_gamma_ctl(ams353_17_285);	break;
			case	13 :	ams353_gamma_ctl(ams353_17_270);	break;
			case	12 :	ams353_gamma_ctl(ams353_17_255);	break;
			case	11 :	ams353_gamma_ctl(ams353_17_240);	break;
			case	10 :	ams353_gamma_ctl(ams353_17_225);	break;
			case	9  :	ams353_gamma_ctl(ams353_17_210);	break;
			case	8  :	ams353_gamma_ctl(ams353_17_195);	break;
			case	7  :	ams353_gamma_ctl(ams353_17_180);	break;
			case	6  :	ams353_gamma_ctl(ams353_17_165);	break;
			case	5  :	ams353_gamma_ctl(ams353_17_150);	break;
			case	4  :	ams353_gamma_ctl(ams353_17_135);	break;
			case	3  :	ams353_gamma_ctl(ams353_17_120);	break;
			case	2  :	ams353_gamma_ctl(ams353_17_105);	break;
			case	1  :	ams353_gamma_ctl(ams353_17_90);     break;
			case	0  :	ams353_gamma_ctl(ams353_50);	    break;
		}
	}
	
	else		// 2.2 gamma
	{
#ifndef LCD_ARIAN_GAMMA
		switch (cd[idx])
		{
			case	300 :	ams353_gamma_ctl(ams353_300);	break;
            //case	285 :	ams353_gamma_ctl(ams353_285);	break;
			case	270 :	ams353_gamma_ctl(ams353_270);	break;
            //	case	255 :	ams353_gamma_ctl(ams353_255);	break;
			case	240 :	ams353_gamma_ctl(ams353_240);	break;
			case	225 :	ams353_gamma_ctl(ams353_225);	break;
			case	210 :	ams353_gamma_ctl(ams353_210);	break;
			case	195 :	ams353_gamma_ctl(ams353_195);	break;
			case	180 :	ams353_gamma_ctl(ams353_180);	break;
			case	165 :	ams353_gamma_ctl(ams353_165);	break;
			case	150 :	ams353_gamma_ctl(ams353_150);	break;
			case	135 :	ams353_gamma_ctl(ams353_135);	break;
			case	120 :	ams353_gamma_ctl(ams353_120);	break;
			case	105 :	ams353_gamma_ctl(ams353_105);	break;
			case	90  :	ams353_gamma_ctl(ams353_90);	break;
			case	80  :	ams353_gamma_ctl(ams353_80);	break;
			case	70  :	ams353_gamma_ctl(ams353_70);	break;			
			case	50  :	ams353_gamma_ctl(ams353_50);	break;
		}
#else
		switch (idx)
		{	
			case	27 :	ams353_gamma_ctl(ams353_300);	break;
			case	26 :	ams353_gamma_ctl(ams353_290);	break;
			case	25 :	ams353_gamma_ctl(ams353_280);	break;
			case	24 :	ams353_gamma_ctl(ams353_270);	break;
			case	23 :	ams353_gamma_ctl(ams353_260);	break;
			case	22 :	ams353_gamma_ctl(ams353_250);	break;
			case	21 :	ams353_gamma_ctl(ams353_240);	break;
			case	20 :	ams353_gamma_ctl(ams353_230);	break;
			case	19 :	ams353_gamma_ctl(ams353_220);	break;
			case	18 :	ams353_gamma_ctl(ams353_210);	break;
			case	17 :	ams353_gamma_ctl(ams353_200);	break;
			case	16 :	ams353_gamma_ctl(ams353_190);	break;
			case	15 :	ams353_gamma_ctl(ams353_180);	break;
			case	14 :	ams353_gamma_ctl(ams353_170);	break;
			case	13 :	ams353_gamma_ctl(ams353_160);	break;
			case	12 :	ams353_gamma_ctl(ams353_150);	break;
			case	11 :	ams353_gamma_ctl(ams353_140);	break;
			case	10 :	ams353_gamma_ctl(ams353_130);	break;
			case	9  :	ams353_gamma_ctl(ams353_120);	break;
			case	8  :	ams353_gamma_ctl(ams353_110);	break;
			case	7  :	ams353_gamma_ctl(ams353_100);	break;
			case	6  :	ams353_gamma_ctl(ams353_90);		break;
			case	5  :	ams353_gamma_ctl(ams353_80);		break;
			case	4  :	ams353_gamma_ctl(ams353_70);		break;
			case	3  :	ams353_gamma_ctl(ams353_60);		break;
			case	2  :	ams353_gamma_ctl(ams353_50);		break;
			case	1  :	ams353_gamma_ctl(ams353_40);		break;
			case	0  :	ams353_gamma_ctl(ams353_30);		break;
		}
#endif		
	}
}

void ams353_lcd_brightness_on(void)
{
    //	printk(KERN_DEBUG "%s\n", __FUNCTION__);
	ams353_lcd_brightness_setting(lcdlevel, lcdgamma);
}

static void spi1writeindex(u8 index)
{
	volatile unsigned short cmd = 0;
	cmd= 0x0000|index;

	spi_write(ams353lcd_spi,(unsigned char*)&cmd,2);

	udelay(100);
	udelay(100);
}

static void spi1writedata(u8 data)
{
	volatile unsigned short datas = 0;
	datas= 0x0100|data;
	spi_write(ams353lcd_spi,(unsigned char*)&datas,2);

	udelay(100);
	udelay(100);
}

void ams353_gamma_ctl(u8 *gamma)
{
	u16 data = 0;
	
	spi1writeindex(0xFA);	

	for(data = 0; data < 23; data++)
	{
		spi1writedata(gamma[data]);
	}
	
	// Gamma Set Update
	spi1writeindex(0xFA);	
	spi1writedata(0x03);	// 1st Gamma Set update enable	
}

#ifdef __AMS35X_ACL_LEVEL_40__
void ams353_AutomaticCurrentLimit()
{
    u8   AKR, AKG, AKB;
	
    AKR = 0x4D;
    AKG = 0x96;
    AKB = 0x1D;

    // Level2 command valid
    spi1writeindex(0xF0);	
    spi1writedata(0x5A);	
    spi1writedata(0x5A);

    // ACL Coefficient
    spi1writeindex(0xC1);	
    spi1writedata(AKR);	
    spi1writedata(AKG);
    spi1writedata(AKB);
	
    // ACL window horizontal start point, 0x01DF = 479
    spi1writedata(0x00);
    spi1writedata(0x00);
    spi1writedata(0x01);
    spi1writedata(0xDF);

    // ACL window vertical start point, 0x031F = 799
    spi1writedata(0x00);
    spi1writedata(0x00);
    spi1writedata(0x03);
    spi1writedata(0x1F);

	switch(lcdlevel)
	{
		case 15:
		case 14:
		case 13:
		case 12:
		case 11:
		case 10:
		case  9:
		case  8:
		case  7:
		case  6:
		case  5:		// ACL - 40 %
			spi1writedata(0x00);  // Para. 12
			spi1writedata(0x00);  // Para. 13
			spi1writedata(0x00);  // Para. 14
			spi1writedata(0x00);  // Para. 15
			spi1writedata(0x00);  // Para. 16
			spi1writedata(0x01);  // Para. 17
			spi1writedata(0x06);  // Para. 18
			spi1writedata(0x0B);  // Para. 19
			spi1writedata(0x11);  // Para. 20
			spi1writedata(0x16);  // Para. 21
			spi1writedata(0x1B);  // Para. 22
			spi1writedata(0x20);  // Para. 23
			spi1writedata(0x25);  // Para. 24
			spi1writedata(0x2B);  // Para. 25
			spi1writedata(0x30);  // Para. 26
			spi1writedata(0x35);  // Para. 27
			break;
			
		case  4:		// ACL - 33%
			spi1writedata(0x00);  // Para. 12
			spi1writedata(0x00);  // Para. 13
			spi1writedata(0x00);  // Para. 14
			spi1writedata(0x00);  // Para. 15
			spi1writedata(0x00);  // Para. 16
			spi1writedata(0x01);  // Para. 17
			spi1writedata(0x05);  // Para. 18
			spi1writedata(0x09);  // Para. 19
			spi1writedata(0x0E);  // Para. 20
			spi1writedata(0x12);  // Para. 21
			spi1writedata(0x16);  // Para. 22
			spi1writedata(0x1A);  // Para. 23
			spi1writedata(0x1E);  // Para. 24
			spi1writedata(0x23);  // Para. 25
			spi1writedata(0x27);  // Para. 26
			spi1writedata(0x2B);  // Para. 27
			break;
			
		case  3:		// ACL - 22%
			spi1writedata(0x00);  // Para. 12
			spi1writedata(0x00);  // Para. 13
			spi1writedata(0x00);  // Para. 14
			spi1writedata(0x00);  // Para. 15
			spi1writedata(0x00);  // Para. 16
			spi1writedata(0x01);  // Para. 17
			spi1writedata(0x04);  // Para. 18
			spi1writedata(0x06);  // Para. 19
			spi1writedata(0x09);  // Para. 20
			spi1writedata(0x0C);  // Para. 21
			spi1writedata(0x0F);  // Para. 22
			spi1writedata(0x11);  // Para. 23
			spi1writedata(0x14);  // Para. 24
			spi1writedata(0x17);  // Para. 25
			spi1writedata(0x19);  // Para. 26
			spi1writedata(0x1C);  // Para. 27
			break;
			
		case  2:		// ACL - 12%
			spi1writedata(0x00);  // Para. 12
			spi1writedata(0x00);  // Para. 13
			spi1writedata(0x00);  // Para. 14
			spi1writedata(0x00);  // Para. 15
			spi1writedata(0x00);  // Para. 16
			spi1writedata(0x01);  // Para. 17
			spi1writedata(0x03);  // Para. 18
			spi1writedata(0x04);  // Para. 19
			spi1writedata(0x06);  // Para. 20
			spi1writedata(0x07);  // Para. 21
			spi1writedata(0x09);  // Para. 22
			spi1writedata(0x0A);  // Para. 23
			spi1writedata(0x0C);  // Para. 24
			spi1writedata(0x0D);  // Para. 25
			spi1writedata(0x0F);  // Para. 26
			spi1writedata(0x10);  // Para. 27
			break;			
	}
		
	udelay( 100 );
	return ;
}

#else
void ams353_AutomaticCurrentLimit()
{
    u8   AKR, AKG, AKB;
	
    AKR = 0x4D;
    AKG = 0x96;
    AKB = 0x1D;

    // Level2 command valid
    spi1writeindex(0xF0);	
    spi1writedata(0x5A);	
    spi1writedata(0x5A);

    // ACL Coefficient
    spi1writeindex(0xC1);	
    spi1writedata(AKR);	
    spi1writedata(AKG);
    spi1writedata(AKB);

    // ACL window horizontal start point, 0x01DF = 479
    spi1writedata(0x00);
    spi1writedata(0x00);
    spi1writedata(0x01);
    spi1writedata(0xDF);

    // ACL window vertical start point, 0x031F = 799
    spi1writedata(0x00);
    spi1writedata(0x00);
    spi1writedata(0x03);
    spi1writedata(0x1F);

	switch(lcdlevel)
	{
		case 15:
		case 14:
		case 13:
		case 12:
		case 11:
		case 10:
		case  9:
		case  8:
		case  7:		// ACL - 50 %
			spi1writedata(0x00);  // Para. 12
			spi1writedata(0x00);  // Para. 13
			spi1writedata(0x00);  // Para. 14
			spi1writedata(0x00);  // Para. 15
			spi1writedata(0x00);  // Para. 16
			spi1writedata(0x01);  // Para. 17
			spi1writedata(0x08);  // Para. 18
			spi1writedata(0x0F);  // Para. 19
			spi1writedata(0x16);  // Para. 20
			spi1writedata(0x1D);  // Para. 21
			spi1writedata(0x24);  // Para. 22
			spi1writedata(0x2A);  // Para. 23
			spi1writedata(0x31);  // Para. 24
			spi1writedata(0x38);  // Para. 25
			spi1writedata(0x3F);  // Para. 26
			spi1writedata(0x46);  // Para. 27
			break;
			
		case  6:		// ACL - 48%
			spi1writedata(0x00);  // Para. 12
			spi1writedata(0x00);  // Para. 13
			spi1writedata(0x00);  // Para. 14
			spi1writedata(0x00);  // Para. 15
			spi1writedata(0x00);  // Para. 16
			spi1writedata(0x01);  // Para. 17
			spi1writedata(0x08);  // Para. 18
			spi1writedata(0x0E);  // Para. 19
			spi1writedata(0x15);  // Para. 20
			spi1writedata(0x1B);  // Para. 21
			spi1writedata(0x22);  // Para. 22
			spi1writedata(0x28);  // Para. 23
			spi1writedata(0x2F);  // Para. 24
			spi1writedata(0x35);  // Para. 25
			spi1writedata(0x3C);  // Para. 26
			spi1writedata(0x42);  // Para. 27
			break;	
			
		case  5:		// ACL - 40%		
			spi1writedata(0x00);  // Para. 12
			spi1writedata(0x00);  // Para. 13
			spi1writedata(0x00);  // Para. 14
			spi1writedata(0x00);  // Para. 15
			spi1writedata(0x00);  // Para. 16
			spi1writedata(0x01);  // Para. 17
			spi1writedata(0x06);  // Para. 18
			spi1writedata(0x0B);  // Para. 19
			spi1writedata(0x11);  // Para. 20
			spi1writedata(0x16);  // Para. 21
			spi1writedata(0x1B);  // Para. 22
			spi1writedata(0x20);  // Para. 23
			spi1writedata(0x25);  // Para. 24
			spi1writedata(0x2B);  // Para. 25
			spi1writedata(0x30);  // Para. 26
			spi1writedata(0x35);  // Para. 27
			break;	
			
		case  4:		// ACL - 33%
			spi1writedata(0x00);  // Para. 12
			spi1writedata(0x00);  // Para. 13
			spi1writedata(0x00);  // Para. 14
			spi1writedata(0x00);  // Para. 15
			spi1writedata(0x00);  // Para. 16
			spi1writedata(0x01);  // Para. 17
			spi1writedata(0x05);  // Para. 18
			spi1writedata(0x09);  // Para. 19
			spi1writedata(0x0E);  // Para. 20
			spi1writedata(0x12);  // Para. 21
			spi1writedata(0x16);  // Para. 22
			spi1writedata(0x1A);  // Para. 23
			spi1writedata(0x1E);  // Para. 24
			spi1writedata(0x23);  // Para. 25
			spi1writedata(0x27);  // Para. 26
			spi1writedata(0x2B);  // Para. 27
			break;
			
		case  3:		// ACL - 22%
			spi1writedata(0x00);  // Para. 12
			spi1writedata(0x00);  // Para. 13
			spi1writedata(0x00);  // Para. 14
			spi1writedata(0x00);  // Para. 15
			spi1writedata(0x00);  // Para. 16
			spi1writedata(0x01);  // Para. 17
			spi1writedata(0x04);  // Para. 18
			spi1writedata(0x06);  // Para. 19
			spi1writedata(0x09);  // Para. 20
			spi1writedata(0x0C);  // Para. 21
			spi1writedata(0x0F);  // Para. 22
			spi1writedata(0x11);  // Para. 23
			spi1writedata(0x14);  // Para. 24
			spi1writedata(0x17);  // Para. 25
			spi1writedata(0x19);  // Para. 26
			spi1writedata(0x1C);  // Para. 27
			break;
			
		case  2:		// ACL - 12%
			spi1writedata(0x00);  // Para. 12
			spi1writedata(0x00);  // Para. 13
			spi1writedata(0x00);  // Para. 14
			spi1writedata(0x00);  // Para. 15
			spi1writedata(0x00);  // Para. 16
			spi1writedata(0x01);  // Para. 17
			spi1writedata(0x03);  // Para. 18
			spi1writedata(0x04);  // Para. 19
			spi1writedata(0x06);  // Para. 20
			spi1writedata(0x07);  // Para. 21
			spi1writedata(0x09);  // Para. 22
			spi1writedata(0x0A);  // Para. 23
			spi1writedata(0x0C);  // Para. 24
			spi1writedata(0x0D);  // Para. 25
			spi1writedata(0x0F);  // Para. 26
			spi1writedata(0x10);  // Para. 27
			break;			
	}
		
	udelay( 100 );
	return ;
}
#endif

void ams353_ACL_enable(int on)
{
#ifndef LCD_ARIAN_GAMMA
	if (lcdlevel > 15 || lcdlevel < 2)
#else
	if (lcdlevel > 27 || lcdlevel < 1)
#endif 
	{
		printk(KERN_INFO"[LCD] %s. brightness : %d -> OverRange. FAIL.\n", __FUNCTION__, lcdlevel);
		return;
	}

	printk(KERN_INFO"[LCD] %s. brightness : %d, state : %d\n", __FUNCTION__, lcdlevel, on);
	if (on)
	{
        // ams353_AutomaticCurrentLimit();
		// ACL ON
		spi1writeindex(0xC0);	
		spi1writedata(0x01);	
	}
	else
	{
		// ACL OFF
		spi1writeindex(0xC0);	
		spi1writedata(0x00);	
	}
	return;
}

void ams353_DynamicELVSS(void)
{
	// DynamicELVSS Parameters
	spi1writeindex(0xB2);	
	spi1writedata(0x0B);	//  10C <  TPANEL <= 70C, -4.4V
	spi1writedata(0x06);	//   0C < TPANEL <= 10C, -4.9V 
	spi1writedata(0x06);	// -10C < TPANEL <=  0C, -4.9V 
	spi1writedata(0x06);	// -20C < TPANEL <= -10C, -4.9V 
}

void ams353_DynamicELVSS_enable(int on)
{
	printk(KERN_DEBUG"[LCD] %s : %d\n", __FUNCTION__, on);

	if (on)
	{
		// DynamicELVSS ON
		spi1writeindex(0xB1);	
		spi1writedata(0x0A);	
	}
	else
	{
		// DynamicELVSS OFF
		spi1writeindex(0xB1);	
		spi1writedata(0x0B);	
	}
	return;
}

void ams353_ldi_standby(void)
{
	// Sleep-in
	spi1writeindex(0x10);	

	// Wait for 200ms
	msleep(200);
}

void ams353_ldi_wakeup(void)
{
	// Sleep-out
	spi1writeindex(0x11);	

	// Wait for 200ms
	msleep(200);
}

void ams353_ldi_poweron(void)
{
	printk(KERN_DEBUG "[LCD] ams353_ldi_poweron. IN \n");
	//Wait for minimum 10ms
	msleep(10);
	
	//1. Panel Condition SET
	spi1writeindex(0xF8);	
	spi1writedata(0x01);	// 1st DOCT
	spi1writedata(0x27);	// 2nd CLWEA 
	spi1writedata(0x27);	// 3rd CLWEB 
	spi1writedata(0x07);	// 4th CLTE
	spi1writedata(0x07);	// 5th SHE
	spi1writedata(0x54);	// 6th FLTE
	spi1writedata(0x9F);	// 7th FLWE
	spi1writedata(0x63);	// 8th SCTE
	spi1writedata(0x86);	// 9th SCWE
	spi1writedata(0x1A);	// 10th INTE
	spi1writedata(0x33);	// 11th INWE
	spi1writedata(0x0D);	// 12th EMPS
	spi1writedata(0x00);	// 13th E_INTE
	spi1writedata(0x00);	// 14th E_INWE

	//2. Display Condition SET (RGB Data Interface)
	spi1writeindex(0xF2);	
	spi1writedata(0x02);	// 1st 800 Line
	spi1writedata(0x03);	// 2nd VBP : 3 hsync 
	spi1writedata(0x1C);	// 3rd VFP : 28 hsync
    spi1writedata(0x10);	// 4th HBP : 16 Dotclk
    spi1writedata(0x10);	// 5th HFP : 16 Dotclk

	spi1writeindex(0xF7);	
	spi1writedata(0x03);	// 1st GTCon (reverse-direction Display)
	spi1writedata(0x00);	// 2nd Display Mode : 16M color
	spi1writedata(0x00);	// 3rd Vsync/Hsync/Enable : Low active, DOCCLK : Rising edge active, RGB 24 Bits

	//3. Gamma Condition SET (2.2gamma, 300cd/m)
	ams353_lcd_brightness_on();

	//4. Etc Condition SET
	spi1writeindex(0xF6);	
	spi1writedata(0x00);	// 1st 
	spi1writedata(0x8E);	// 2nd
	spi1writedata(0x07);	// 3rd  

	spi1writeindex(0xB3);	
	spi1writedata(0x0C);	// 1st 

	ams353_AutomaticCurrentLimit();
	ams353_ACL_enable(lcdacl);
	ams353_DynamicELVSS();
	ams353_DynamicELVSS_enable(1);

	msleep(1);
	spi1writeindex(0x11);	// Stand-by off cmd - 11h
	// remove delay for lcd on speed, msleep(200);
	spi1writeindex(0x29);	// Display on cmd - 29h    

    ldi_power_status = LDI_POWER_ON; // Archer_LSJ DD14 
	printk(KERN_DEBUG "[LCD] ams353_ldi_poweron. OUT \n");
}

void ams353_ldi_poweroff(void)
{
	printk(KERN_DEBUG "[LCD] ams353_ldi_poweroff.\n");

	//Stand-by Off Command : 10h
	spi1writeindex(0x10);	
    
	//Whole Black Screen	//(Wait for several Frame)
	msleep(200);            // Archer_LSJ DC01 : 200 => 120 => 200 
	
    ldi_power_status = LDI_POWER_OFF; // Archer_LSJ DD14 
}

void ams353_lcd_LDO_on(void)
{
	int ret;
	
	ret = regulator_enable( vaux3 ); //VAUX2 - 1.8V
	if ( ret )
		printk("Regulator vaux2 error!!\n");

	ret = regulator_enable( vaux4 ); //VAUX3 - 2.8V
	if ( ret )
		printk("Regulator vaux3 error!!\n");

	ret = regulator_enable( vpll2 );
	if ( ret )
		printk("Regulator vpll2 error!!\n");

	#if (CONFIG_ARCHER_REV >= ARCHER_REV11)
	if(hw_revision < 3)
	{
		// FIXME workaround ; resolve sleep current problem when simcard is attached
		gpio_set_value(OMAP_GPIO_USIM_BOOT, 0);
	}
	#endif
}

void ams353_lcd_LDO_off(void)
{
	int ret;

	ret = regulator_disable( vaux4 );
	if ( ret )
		printk("Regulator vaux4 error!!\n");

	ret = regulator_disable( vaux3 );
	if ( ret )
		printk("Regulator vaux3 error!!\n");

	ret = regulator_disable( vpll2 );
	if ( ret )
		printk("Regulator vpll2 error!!\n");

	#if (CONFIG_ARCHER_REV >= ARCHER_REV11)
	if(hw_revision < 3)
	{
		// FIXME workaround ; resolve sleep current problem when simcard is attached
		gpio_set_value(OMAP_GPIO_USIM_BOOT, 1);
	}
	#endif
}

void ams353_lcd_poweroff(void)
{
    // ACL_Soft_Dim(20);
	ams353_ldi_poweroff();

	ams353_lcd_LDO_off();

	// turn OFF VCI (2.8V)
	// turn OFF VDD3 (1.8V)

    // OMAP MCSPI1 PIN NC
    //	omap34xx_pad_set_configs(omap34xx_lcd_off_pins, ARRAY_SIZE(omap34xx_lcd_off_pins));
    omap34xx_pad_set_config_lcd(0x01C8,  OMAP34XX_MUX_MODE7 | OMAP34XX_PIN_INPUT_PULLDOWN);
    omap34xx_pad_set_config_lcd(0x01CA,  OMAP34XX_MUX_MODE7 | OMAP34XX_PIN_INPUT_PULLDOWN);
    omap34xx_pad_set_config_lcd(0x01CC,  OMAP34XX_MUX_MODE7 | OMAP34XX_PIN_INPUT_PULLDOWN);
    omap34xx_pad_set_config_lcd(0x01CE,  OMAP34XX_MUX_MODE7 | OMAP34XX_PIN_INPUT_PULLDOWN);
    
	return;	
}

void ams353_lcd_poweron(void)
{
	// OMAP MCSPI1 PIN PAD CONFIG
	// omap34xx_pad_set_configs(omap34xx_lcd_pins, ARRAY_SIZE(omap34xx_lcd_pins));
	omap34xx_pad_set_config_lcd(0x01C8,  OMAP34XX_MUX_MODE0 | OMAP34XX_PIN_INPUT_PULLUP);
	omap34xx_pad_set_config_lcd(0x01CA,  OMAP34XX_MUX_MODE0 | OMAP34XX_PIN_INPUT_PULLDOWN);
	omap34xx_pad_set_config_lcd(0x01CC,  OMAP34XX_MUX_MODE0 | OMAP34XX_PIN_INPUT_PULLDOWN);
	omap34xx_pad_set_config_lcd(0x01CE,  OMAP34XX_MUX_MODE0 | OMAP34XX_PIN_INPUT_PULLUP);

	gpio_direction_output(OMAP_GPIO_MLCD_RST, 1);

#ifndef CONFIG_MACH_HALO
	gpio_set_value(OMAP_GPIO_MLCD_RST, GPIO_LEVEL_HIGH);
#endif

	ams353_lcd_LDO_on();

#ifndef CONFIG_MACH_HALO	
	mdelay(25); // Wait 25ms
#else
	mdelay(10);
#endif

	// Activate Reset
	gpio_set_value(OMAP_GPIO_MLCD_RST, GPIO_LEVEL_LOW);	

	mdelay(1);
	gpio_set_value(OMAP_GPIO_MLCD_RST, GPIO_LEVEL_HIGH);
	mdelay(1);
	//MLCD pin set to InputPulldown.
	omap_ctrl_writew(0x010C, 0x1c6);

	ams353_ldi_poweron();
	return;
}

static void ams353_set_brightness(struct led_classdev *dev, enum led_brightness value)
{
	int brightness = 0;

	printk(KERN_DEBUG"[LCD] ams353_set_brightness : %d\n", value);
    
	if( value < 0 || value > 255 )
		return;

#ifndef LCD_ARIAN_GAMMA
	if (value == 255) brightness = 15; 		// Max 300cd
	else 
	if (value < 30) brightness = 0;	        // diming, Low BATT 50cd
	else 
		brightness = ((value - 10) * 15) / 255;
#else
	if (value == 255) brightness = 27; 		// Max 300cd
	else 
	if (value < 30) brightness = 0;	        // diming, Low BATT 50cd
	else 
		brightness = (((value - 30) * 27) / 225)+1;
#endif
	if (lcdlevel != brightness)
	{
        lcdlevel = brightness;
        
	    if ( ldi_power_status == LDI_POWER_ON ) // Archer_LSJ DD14 
        {
    		ams353_lcd_brightness_setting(lcdlevel, lcdgamma);
        }
        else 
        {
            printk(KERN_INFO " LCD BRIGHTNESS is not set when LDI power status is Off.\n");
        }
	}
}

static void ams353_set_lcd_gamma(struct led_classdev *dev, enum led_gamma value)
{
	printk(KERN_INFO"[LCD] ams353_set_lcd_gamma : %d\n", value);
    
	if( value < GAMMA_2_2 || value > GAMMA_1_7 )
		return;

	if (lcdgamma != value)
	{
		lcdgamma = value;

        if ( ldi_power_status == LDI_POWER_ON ) // Archer_LSJ DD14 
        {
            ams353_lcd_brightness_setting(lcdlevel, lcdgamma);
        }
        else 
        {
            printk(KERN_INFO " LCD Gamma is not set when LDI power status is Off.");
        }
	}
}

static void ams353_set_lcd_acl(struct led_classdev *dev, enum led_ACL value)
{
	printk(KERN_DEBUG"[LCD] %s : %d\n", __func__, value);
    
	if( value < ACL_OFF || value > ACL_ON )
		return;

	if (lcdacl != value)
	{
		lcdacl = value;
		ams353_ACL_enable(lcdacl);
	}
}

static void set_flash_light(struct led_classdev *dev, enum flashlight_level level)
{
	printk(KERN_INFO"set_flash_light : %d\n", level);
    
	if ( level == 1 )
	{
		gpio_direction_output(OMAP_GPIO_HAND_FLASH, 1); 
	}
	else 
	{
		gpio_direction_output(OMAP_GPIO_HAND_FLASH, 0); 
	}
}

static struct led_classdev ams353_backlight_led = {
	.name = "lcd-backlight",
	.brightness = LCD_DEFAULT_BRIGHTNESS * 25.5,
	.lcd_gamma  = LCD_DEFAULT_GAMMA,
	.acl_state = LCD_DEFAULT_ACL_STATE,
	.hand_flash = HAND_FLASH_DEFAULT,
	.brightness_set = ams353_set_brightness,
	.lcd_gamma_set  = ams353_set_lcd_gamma,
	.lcd_ACL_set = ams353_set_lcd_acl,
	.flashlight_set = set_flash_light,
};

static int ams353_spi_probe(struct spi_device *spi)
{
	printk(KERN_INFO "[LCD] ams353_spi_probe.\n");
	ams353lcd_spi = spi;
	ams353lcd_spi->mode = SPI_MODE_0;
	ams353lcd_spi->bits_per_word = 9 ;
	spi_setup(ams353lcd_spi);
	
	omap_dss_register_driver(&ams353_driver);
	led_classdev_register(&spi->dev, &ams353_backlight_led);
#ifndef CONFIG_FB_OMAP_BOOTLOADER_INIT
	ams353_lcd_poweron();
#endif

	return 0;
}

static int ams353_spi_remove(struct spi_device *spi)
{
	led_classdev_unregister(&ams353_backlight_led);
	omap_dss_unregister_driver(&ams353_driver);

	return 0;
}
static void ams353_spi_shutdown(struct spi_device *spi)
{
#if defined(CONFIG_MACH_SAMSUNG_ARCHER) && defined(CONFIG_PANEL_AMS353)
	printk("First power off LCD.\n");
	ams353_lcd_poweroff();
#endif
}

static int ams353_spi_suspend(struct spi_device *spi, pm_message_t mesg)
{
    //spi_send(spi, 2, 0x01);  /* R2 = 01h */
    //mdelay(40);

	return 0;
}

static int ams353_spi_resume(struct spi_device *spi)
{
	/* reinitialize the panel */
	return 0;
}

static struct spi_driver ams353_spi_driver = {
	.probe    = ams353_spi_probe,
	.remove   = ams353_spi_remove,
	.shutdown = ams353_spi_shutdown,
	.suspend  = ams353_spi_suspend,
	.resume   = ams353_spi_resume,
	.driver   = {
		.name   = "ams353_disp_spi",
		.bus    = &spi_bus_type,
		.owner  = THIS_MODULE,
	},
};

static int __init ams353_lcd_init(void)
{
	return spi_register_driver(&ams353_spi_driver);
}

static void __exit ams353_lcd_exit(void)
{
	return spi_unregister_driver(&ams353_spi_driver);
}

module_init(ams353_lcd_init);
module_exit(ams353_lcd_exit);
MODULE_LICENSE("GPL");
